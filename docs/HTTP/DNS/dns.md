### DNS 域名的解析过程

以 `http://www.cool.sky.com` 为栗子，当用户输入这个 `url` 时，会进行以下步骤：

#### 1. 查找浏览器缓存
浏览器会检查缓存中是否有与这个 `域名` 对应的 `已解析过的IP地址`，如果命中缓存，则解析结束；

#### 2. 查找操作系统缓存
若浏览器的缓存没命中，则会查找操作系统的缓存；因为操作系统也会有一个域名解析的过程，一般可以通过系统文件的 `hosts` 文件来设置 `域名` 和 `IP` 的映射关系，这样就设置了操作系统的域名缓存；

#### 3. 查找路由缓存
如果系统缓存也没命中，那么查询请求就会发向路由器，它一般会有自己的 `DNS` 缓存；

#### 4. 查找 ISP DNS 缓存
如果上述几个步骤，都没有相应的缓存命中，就只能查询 `ISP DNS 缓存服务器`(`ISP` 即 `因特网服务提供商`) 了，也就是 `本地区域名服务器`，它一般会缓存域名的解析结果，缓存的时间受到域名失效时间的影响，大约 `80%` 的域名解析到这里就完成了；

#### 5. 递归搜索
最坏的情况出现了，以上缓存都没有命中，那么将进入递归查询阶段，具体步骤如下：
1. `本地 DNS 域名服务器` 将该请求转发到互联网的根域；
2. `根域` 将所要查询域名的 `顶级域`（假设查询的是 `cool.sky.com`，这里的顶级域就是 `com`）的服务器 `IP地址` 返回给本地 DNS；
3. 本地 `DNS` 接收到 `IP` 地址后，再向 `顶级域` 发起请求；
4. `com` 顶级域再将域名中的二级域的 `IP` 地址返回给 本地 DNS；
5. 如此递归查询，最终本地 `DNS` 将查询结果返回给主机，这个时候就完成了 `DNS` 的解析；